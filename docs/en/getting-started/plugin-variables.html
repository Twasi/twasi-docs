<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Adding variables to a Twasi-Plugin · TwasiDocs</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Adding dynamic variables to your plugin is very easy! The best way to explain how it works is a simple example."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Adding variables to a Twasi-Plugin · TwasiDocs"/><meta property="og:type" content="website"/><meta property="og:url" content="https://github.com/twasi/"/><meta property="og:description" content="Adding dynamic variables to your plugin is very easy! The best way to explain how it works is a simple example."/><meta property="og:image" content="https://github.com/twasi/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://github.com/twasi/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="alternate" type="application/atom+xml" href="https://github.com/twasi/blog/atom.xml" title="TwasiDocs Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://github.com/twasi/blog/feed.xml" title="TwasiDocs Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><img class="logo" src="/img/docs-logo.svg" alt="TwasiDocs"/><h2 class="headerTitleWithLogo">TwasiDocs</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/en/home" target="_self">Developers</a></li><li class=""><a href="/docs/en/users/en/home" target="_self">Users</a></li><li class=""><a href="/en/changelogs" target="_self">Changelogs</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/de-DE/getting-started/plugin-variables">Deutsch</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Getting started</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Welcome</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/en/home">Home</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Core concepts</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/en/core-concepts/twasi-plugin">The Twasi-Plugin</a></li><li class="navListItem"><a class="navItem" href="/docs/en/core-concepts/twasi-command">The Twasi-Command</a></li><li class="navListItem"><a class="navItem" href="/docs/en/core-concepts/twasi-variable">The Twasi-Variable</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/en/getting-started/local-setup">Local Twasi setup</a></li><li class="navListItem"><a class="navItem" href="/docs/en/getting-started/plugin-base">Plugin Base</a></li><li class="navListItem"><a class="navItem" href="/docs/en/getting-started/plugin-commands">Plugin commands</a></li><li class="navListItem"><a class="navItem" href="/docs/en/getting-started/plugin-translations">Plugin translations</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/en/getting-started/plugin-variables">Plugin variables</a></li><li class="navListItem"><a class="navItem" href="/docs/en/getting-started/plugin-permissions">Plugin permissions</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Adding variables to a Twasi-Plugin</h1></header><article><div><span><p>Adding dynamic variables to your plugin is very easy! The best way to explain how it works is a simple example.</p>
<h2><a class="anchor" aria-hidden="true" id="creating-a-variable-controller-class"></a><a href="#creating-a-variable-controller-class" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating a variable controller-class</h2>
<p>We are going to add a variable that returns the current time. We will also use an argument to allow the user to specify a custom formatting.</p>
<p>Let's get started creating a new class called <em>TimeVariable</em>.</p>
<blockquote>
<p>If you have multiple variables, it's a good practice to put them into a package called &quot;variables&quot; or something similar to keep everything cleaned up.</p>
</blockquote>
<pre><code class="hljs css language-java"><span class="hljs-keyword">package</span> de.merlinw.variables;

<span class="hljs-keyword">import</span> net.twasi.core.interfaces.api.TwasiInterface;
<span class="hljs-keyword">import</span> net.twasi.core.models.Message.TwasiMessage;
<span class="hljs-keyword">import</span> net.twasi.core.plugin.api.TwasiUserPlugin;
<span class="hljs-keyword">import</span> net.twasi.core.plugin.api.TwasiVariable;

<span class="hljs-keyword">import</span> java.util.Arrays;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimeVariable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TwasiVariable</span> </span>{
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TimeVariable</span><span class="hljs-params">(TwasiUserPlugin owner)</span> </span>{
        <span class="hljs-keyword">super</span>(owner);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">process</span><span class="hljs-params">(String name, TwasiInterface inf, String[] params, TwasiMessage message)</span> </span>{
        <span class="hljs-comment">// This function is used to resolve the variable</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">getNames</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(<span class="hljs-string">"time"</span>, <span class="hljs-string">"timestamp"</span>);
    }
}
</code></pre>
<p>There are two very important functions that you need to override:</p>
<ul>
<li><p>The first one is the <em>process</em>-function that will be called when Twasi is going to send a message containing a variable that needs to be resolved. The return type is a string. Twasi will replace the variable with whatever you return here. It has four parameters:</p>
<ul>
<li>'String name' is the variable name that was used (because variables can have multiple names/aliases).</li>
<li>'TwasiInterface inf' is the TwasiInterface of the user in whose channel the variable is used.</li>
<li>'String[] params' contains all arguments/parameters that were specified in the brackets at the end of the variable name (will be empty if there are no brackets at all).</li>
<li>'TwasiMessage message' is the TwasiMessage we currently reply to.</li>
</ul></li>
<li><p>The second one is the <em>getNames</em>-function that returns every name the variable should have. The first string in the returned list is the main name of your variable that will be shown in variable lists. All other strings are aliases that can be used too, but won't be listed.</p></li>
</ul>
<p>Now we want to add some logic to our <em>process</em>-function:</p>
<pre><code class="hljs css language-java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">process</span><span class="hljs-params">(String name, TwasiInterface inf, String[] params, TwasiMessage message)</span> </span>{
        SimpleDateFormat hourFormat = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">"HH:mm"</span>);
        <span class="hljs-keyword">return</span> hourFormat.format(Calendar.getInstance().getTime());
    }
</code></pre>
<p>Now our variable returns the current time. Let's add a parameter:</p>
<pre><code class="hljs css language-java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">process</span><span class="hljs-params">(String name, TwasiInterface inf, String[] params, TwasiMessage message)</span> </span>{
        String format = (params.length &gt; <span class="hljs-number">0</span> ? params[<span class="hljs-number">0</span>] : <span class="hljs-string">"HH:mm"</span>);
        SimpleDateFormat hourFormat = <span class="hljs-keyword">new</span> SimpleDateFormat(format);
        <span class="hljs-keyword">return</span> hourFormat.format(Calendar.getInstance().getTime());
    }
</code></pre>
<p>If a parameter is specified, the date parser will use it instead of 'HH:mm'.</p>
<h2><a class="anchor" aria-hidden="true" id="error-handling"></a><a href="#error-handling" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Error handling</h2>
<p>In most cases you don't need to care about error handling at all. If your <em>process</em>-function throws an exception, Twasi will automatically resolve the variable with 'ERROR'. If the exception is an <em>ArrayIndexOutOfBoundsException</em> Twasi will return 'INSUFFICIENT_PARAMETERS'.</p>
<p>Of course you can implement a custom error handling to provide more useful error-messages:</p>
<pre><code class="hljs css language-java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">process</span><span class="hljs-params">(String name, TwasiInterface inf, String[] params, TwasiMessage message)</span> </span>{
        String format = (params.length &gt; <span class="hljs-number">0</span> ? params[<span class="hljs-number">0</span>] : <span class="hljs-string">"HH:mm"</span>);
        SimpleDateFormat hourFormat = <span class="hljs-keyword">new</span> SimpleDateFormat(format);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> hourFormat.format(Calendar.getInstance().getTime());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"INVALID_FORMAT"</span>;
        }
    }
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="registering-variables"></a><a href="#registering-variables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Registering variables</h2>
<p>The last step is to register the variable-controller just like the commands in the <em>TwasiUserPlugin</em>-class of your plugin like this:</p>
<pre><code class="hljs css language-java">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ExampleUserPlugin</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// Register commands</span>
        registerCommand(ExampleCommand.class);
        registerCommand(ExampleStructuredCommand.class);
        
        <span class="hljs-comment">// Register variables</span>
        registerVariable(TimeVariable.class);
    }
</code></pre>
<p>If you changed the signature of your Variable-controller-classes constructor, the syntax above will throw an error. You can use this syntax instead:</p>
<pre><code class="hljs css language-java">    registerVariable(<span class="hljs-keyword">new</span> TimeVariable(<span class="hljs-keyword">this</span>, otherParameters));
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="continue"></a><a href="#continue" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Continue</h2>
<p>In the <a href="/docs/getting-started/plugin-permissions">next part</a> of the &quot;Getting started&quot; series you will learn how to use permissions in your plugin!</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/en/getting-started/plugin-translations"><span class="arrow-prev">← </span><span>Plugin translations</span></a><a class="docs-next button" href="/docs/en/getting-started/plugin-permissions"><span>Plugin permissions</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#creating-a-variable-controller-class">Creating a variable controller-class</a></li><li><a href="#error-handling">Error handling</a></li><li><a href="#registering-variables">Registering variables</a></li><li><a href="#continue">Continue</a></li></ul></nav></div><footer style="background:#1a2035;color:#afb6c5" class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo_small.png" alt="TwasiDocs" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/users/home.html">User Documentation</a><a href="/docs/en/home.html">Developer Documentation</a><a href="/docs/en/doc3.html">API Reference</a></div><div><h5>Community</h5><a href="https://discord.gg/sQyhWrG">Discord</a><a href="https://twitter.com/twasinet" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/twasi" target="_blank">GitHub</a></div><div><h5>Legals</h5><a href="/blog">Privacy</a><a href="/blog">Terms of Use</a><a href="/blog">Imprint</a></div></section><section class="copyright">Copyright © 2019 Twasi | Twasi.NET | Docs.Twasi.NET</section></footer></div></body></html>